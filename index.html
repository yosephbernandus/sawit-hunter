<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-4YBQBER0XY"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-4YBQBER0XY");
    </script>
    <title>Sawit Hunter üå¥</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Quicksand:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />

    <!-- Preload PixiJS from CDN for faster loading -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/pixi.js@8.15.0/dist/pixi.min.js" as="script" crossorigin />

    <!-- Preload critical assets for faster loading -->
    <link rel="preload" href="dist/game.bundle.js" as="script" />
    <link rel="preload" href="assets/svgs/bucket.svg" as="image" />
    <link rel="preload" href="assets/png/sawit-new.webp" as="image" />
    <link rel="preload" href="assets/png/sawit-tree.webp" as="image" />
    <link rel="preload" href="assets/png/sawit-tree-farm.webp" as="image" />
    <link rel="preload" href="assets/sounds/jokowi-kaget.mp3" as="audio" />
    <link rel="preload" href="assets/sounds/solid.mp3" as="audio" />
    <link rel="preload" href="assets/sounds/selamat-berjuang-jokowi.mp3" as="audio" />

    <!-- Load PixiJS from CDN (cached globally, parallel with page load) -->
    <script src="https://cdn.jsdelivr.net/npm/pixi.js@8.15.0/dist/pixi.min.js" crossorigin></script>
  </head>

  <body>
    <div class="stars"></div>
    <div class="twinkling"></div>

    <!-- Loading Screen -->
    <div id="loadingScreen" class="screen">
      <div class="game-title">
        <img class="title-emoji" src="assets/png/sawit-tree.webp" alt="palm tree" />
        <h1>SAWIT<br />HUNTER</h1>
        <img class="title-emoji" src="assets/png/sawit-tree.webp" alt="palm tree" />
      </div>
      <div class="loading-container">
        <div class="loading-bar">
          <div class="loading-fill" id="loadingFill"></div>
        </div>
        <div class="loading-text" id="loadingText">Loading assets...</div>
      </div>
    </div>

    <div id="startScreen" class="screen" style="display: none;">
      <div class="game-title">
        <img class="title-emoji" src="assets/png/sawit-tree.webp" alt="palm tree" />
        <h1>SAWIT<br />HUNTER</h1>
        <img class="title-emoji" src="assets/png/sawit-tree.webp" alt="palm tree" />
      </div>
      <div class="game-subtitle">Catch the falling palm fruits!</div>
      <div class="input-container">
        <input
          id="usernameInput"
          placeholder="Enter your name"
          maxlength="15"
        />
      </div>
      <button id="playBtn" class="game-btn">
        <span class="btn-text">START GAME</span>
        <span class="btn-icon">üéÆ</span>
      </button>
      <div class="high-score-display" id="highScoreDisplay"></div>
    </div>

    <div id="gameContainer" class="game-container">
      <div class="game-ui">
        <div class="ui-left">
          <div class="stat-box">
            <div class="stat-label">PLAYER</div>
            <div class="stat-value" id="playerName">---</div>
          </div>
        </div>
        <div class="ui-center">
          <div class="stat-box score-box">
            <div class="stat-label">SCORE</div>
            <div class="stat-value score-value" id="scoreDisplay">0</div>
          </div>
        </div>
        <div class="ui-right">
          <div class="stat-box">
            <div class="stat-label">HIGH</div>
            <div class="stat-value" id="highScore">0</div>
          </div>
        </div>
      </div>
      <div class="game-main">
        <div class="canvas-wrapper">
          <canvas id="gameCanvas"></canvas>
        </div>
        <div class="controls-guide">
          <div class="guide-title">CONTROLS</div>
          <div class="guide-section">
            <div class="guide-label">MOVE</div>
            <div class="key-row">
              <div class="key-group">
                <div class="key-key">‚Üê</div>
                <div class="key-key">‚Üí</div>
              </div>
              <div class="key-or">or</div>
              <div class="key-group">
                <div class="key-key">A</div>
                <div class="key-key">D</div>
              </div>
            </div>
          </div>
          <div class="guide-section">
            <div class="guide-label">SPRINT</div>
            <div class="key-row">
              <div class="key-key key-wide">SHIFT</div>
              <div class="key-plus">+</div>
              <div class="key-group">
                <div class="key-key">‚Üê</div>
                <div class="key-key">‚Üí</div>
              </div>
              <div class="key-or">or</div>
              <div class="key-group">
                <div class="key-key">A</div>
                <div class="key-key">D</div>
              </div>
            </div>
          </div>
          <div class="guide-section">
            <div class="guide-label">DRAG</div>
            <div class="key-row">
              <div class="key-mouse">üñ±Ô∏è</div>
            </div>
          </div>
        </div>
      </div>
      <div class="mobile-controls">
        <button class="control-btn" id="leftBtn">‚óÄ</button>
        <button class="control-btn" id="rightBtn">‚ñ∂</button>
      </div>
    </div>

    <div id="gameOverScreen" class="screen">
      <div class="game-over-content">
        <h2 class="game-over-title">GAME OVER</h2>
        <div id="gameOverText" class="game-over-message"></div>
        <div class="final-score-box">
          <div class="final-score-label">Final Score</div>
          <div class="final-score-value" id="finalScore">0</div>
        </div>
        <button id="restartBtn" class="game-btn restart-btn">
          <span class="btn-text">PLAY AGAIN</span>
          <span class="btn-icon">üîÑ</span>
        </button>
        <div class="support-cta">
          <p class="support-text">
            Building projects like this is easy when you have access to
            electricity and basic needs met. If you'd like to support, please
            consider redirecting your support our brothers and sisters in Aceh.
          </p>
          <a
            class="support-link"
            href="https://kitabisa.com/campaign/tanggapbencanaaceh"
            target="_blank"
            rel="noopener noreferrer"
          >
            <span class="link-text">Support Aceh via Kitabisa</span>
            <span class="link-icon">‚ù§Ô∏è</span>
          </a>
        </div>
      </div>
    </div>

    <!-- Audio files with preload="metadata" for faster initial load -->
    <!-- Only critical sounds use preload="auto" -->
    <audio
      id="scoreSound"
      src="assets/sounds/hey-antek-antek-asing-prabowo.mp3"
      preload="metadata"
    ></audio>
    <audio
      id="deathSound"
      src="assets/sounds/hidup-jokowi.mp3"
      preload="metadata"
    ></audio>
    <audio
      id="catchSound"
      src="assets/sounds/jokowi-kaget.mp3"
      preload="auto"
    ></audio>
    <audio
      id="spawnSound"
      src="assets/sounds/solid.mp3"
      preload="auto"
    ></audio>
    <audio
      id="menuMusic"
      src="assets/sounds/selamat-berjuang-jokowi.mp3"
      loop
      preload="auto"
    ></audio>
    <audio
      id="endingMusic"
      src="assets/sounds/penyanyi-solo-gatau-siapa.mp3"
      loop
      preload="metadata"
    ></audio>

    <!-- Development: use game.js with Bun bundling -->
    <!-- Production: use dist/game.bundle.js -->
    <script type="module" src="dist/game.bundle.js"></script>
  </body>
</html>
